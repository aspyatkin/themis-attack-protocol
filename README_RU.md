# Themis Finals Attack Protocol
**К сведению:** Данный документ также доступен на [английском языке](README.md).

Данный репозиторий содержит инструкции по отправке захваченных флагов серверу [Themis Finals](https://github.com/aspyatkin/themis-finals) - проверяющей системы соревнований в формате CTF.

Данная система была использована на следующих соревнованиях:
 - [VolgaCTF 2015 Finals](https://volgactf.ru) 10 сентября 2015 г.;
 - [RCC-2016](http://rcc.zone) 11 мая 2016 г.;
 - SamaraCTF 24 апреля 2016 г.;
 - [VolgaCTF 2016 Finals](https://volgactf.ru) 15 сентября 2016 г.

## Предварительные требования
1. Вам должен быть известен IP адрес или полное доменное имя (FQDN) сервера проверяющей системы.
2. На вашем компьютере должна быть установлена утилита командной строки для отправки запросов HTTP.

## Отправка флагов
Предполагая, что сервера проверяющей системы имеет IP адрес `10.0.0.2`, и на вашем компьютере установлен [curl](http://curl.haxx.se):  
1. Захватите флаги. Помните, правильный флаг должен соответствовать регулярному выражению `/^[\da-f]{32}=$/`.  
2. Сконструируйте массив флагов в формате JSON. К примеру,
`["b5c8b7c23cec74a903f764ec202d7c5c=","2bc1da92090e8b13d2950fc517752eea="]`  
3. Выполните HTTP запрос на сервер:  
`$ curl -X POST -v -H "Content-Type: application/json" -d "[\"b5c8b7c23cec74a903f764ec202d7c5c=\",\"2bc1da92090e8b13d2950fc517752eea=\"]" http://10.0.0.2/api/submit`  
4. Проанализируйте ответ сервера. Вы получите одно число в случае возникновения общей ошибки (например, из-за неправильного формата данных или приостановки соревнования). Иначе вы получите массив чисел, каждое из которых будет соответствовать результату атаки для каждого флага. Возможные коды результата приведены ниже.

## Коды результата атаки
| Код | Описание |
|-----|----------|
|0|Присланный флаг принят|
|1|Общая ошибка|
|2|Атакующая сторона не из подсети соревнующихся команд|
|3|Соревнование ещё не началось|
|4|Соревнование приостановлено|
|5|Соревнование закончено|
|6|Присланные данные имеют неверный формат|
|7|Исчерпан лимит попыток атаки|
|8|У присланного флага истекло время жизни|
|9|Присланный флаг принадлежит атакующей команде и поэтому не может быть принят|
|10|Присланный флаг уже был принят ранее|
|11|Присланный флаг не найден|
|12|Сервис атакующей команды не находится в рабочем состоянии (UP), поэтому флаги с сервисов других команд не могут быть приняты|

## Замечания
1. Размер запроса ограничен 1024 байтами. Вы можете спокойно посылать до 25 флагов единовременно.
2. Перед отправкой флагов с сервиса `N`, захваченных у вашего соперника, пожалуйста, убедитесь, что **ваш** сервис `N` находится в рабочем состоянии (UP).
3. На приём флагов имеются некоторые ограничения. Вы можете делать не более чем `X` попыток атаки (один флаг) за последние `Y` секунд. Считаются как успешные, так и неудачные попытки. К примеру, если `X` равен 100, а `Y` равно 60, вы можете совершить 100 попыток атаки за минуту (если вы посылаете 25 флагов в одном запросе, то можно соответственно сделать 4 таких запроса в минуту). Организационный комитет соревнований должен прояснить соревнующимся актуальные значения `X` и `Y`.

## Лицензия
MIT @ [Пяткин Александр](https://github.com/aspyatkin)
